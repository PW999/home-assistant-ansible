---
dependency:
  name: galaxy
driver:
  name: docker
lint: |
    set -e
    yamllint .
    ansible-lint
    flake8
platforms:
  - name: debian10-systemd
    dockerfile: ../../../resources/Dockerfile.j2
    build_image: true
    image: debian:10.10
    command: /sbin/init
    # pre_build_image: true
    tmpfs:
      - /run
      - /tmp
    volumes:
      - /sys/fs/cgroup:/sys/fs/cgroup:ro
  - name: ubuntu21-systemd
    dockerfile: ../../../resources/Dockerfile.j2
    build_image: true
    image: ubuntu:21.04
    command: /sbin/init
    # pre_build_image: true
    tmpfs:
      - /run
      - /tmp
    volumes:
      - /sys/fs/cgroup:/sys/fs/cgroup:ro
    env:
      DEBIAN_FRONTEND: noninteractive
      TZ: Europe/Brussels
  - name: ubuntu20-systemd
    dockerfile: ../../../resources/Dockerfile.j2
    build_image: true
    image: ubuntu:20.04
    command: /sbin/init
    # pre_build_image: true
    tmpfs:
      - /run
      - /tmp
    volumes:
      - /sys/fs/cgroup:/sys/fs/cgroup:ro
    env:
      DEBIAN_FRONTEND: noninteractive
      TZ: Europe/Brussels
provisioner:
  name: ansible
  playbooks:
    converge: ./converge.yml
verifier:
  name: testinfra
  directory: ./tests/
